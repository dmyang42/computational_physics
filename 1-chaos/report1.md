## <center>**计算物理 作业报告1**</center>

<center>PB16000647 羊达明</center>


#### **题目:**
以 $x_{n+1} = \lambda sin(\pi x_{n})$ 为迭代方程：

1.  画出系统状态随参数$\lambda$的变化图，要求包括定值状态、倍周期分叉和混沌状态；
2. 列出各个倍周期分叉处的$\lambda$值，求相应的 $Feigenbaum$ 常数。


<br>

#### **算法思路:**

**1. 求出系统状态随参数 $\lambda$ 的曲线**

首先确定 $\lambda$ 取值的区间和步长，对于每一个 $\lambda$ 从给定初始值 $x_{0}$ 开始迭代，输出最后 $N$ 次迭代的值。 

每个输出的数据点横坐标为 $\lambda$ 、纵坐标为 $x$ ，每个 $\lambda$ 有 $N$ 个数据点。

**2. 倍周期分叉点**

程序中使用 $Lyapunov$ 指数来判断倍周期分叉点，当 $Lyapunov$ 指数等于零时，即为倍周期分叉点。
实际计算倍周期分叉点的算法是采用最简单的近似，即对最后200个数据点对应导函数值取对数后再取平均值，来逼近一个极限，在 [plot.py](./plot.py) 中的 ``def lyapunov (x, l, lambda_start, lambda_end, lambda_update)`` 方法中实现。

<br>

#### **程序使用说明:** 

编程环境：**Ubuntu(zsh) / gcc / Python**

- ``chaos.c``  计算所有数据点的C程序
- ``chaos / a.out`` 均是``chaos.c``编译后的可执行文件
- ``plot.py`` 为用 Python 编写绘图及判断倍周期分叉点的脚本
- ``test.sh`` 把上述文件整合在一起执行的shell脚本，使用zsh来来执行，若未装zsh下文中的命令可改为``bash test.sh``

在终端中执行以下命令：

```shell
$ ./test.sh 0 1 0.0001 0.11 0
$ mkdir test0 && mv *_0* ./test0

# 第一个参数为起始点
# 第二个参数为终止点
# 第三个参数为步长
# 第四个参数为x0
# 第五个参数为测试编号
# 完成后建立相应文件夹并把生成出的东西移动到文件夹中
```

最后在 $test0$ 文件夹中得到以下文件：

- peak_0 : 是对 $Lyapunov$ 指数数据寻峰结果

- test_0 : 所有数据点

- test_chaos_0.png : $\lambda-x$ 图

- test_lyapunov_0.png : $\lambda-lyapunov$ 图 

<br>

#### **计算结果:**
下面四张图起始点都是 $0$ ，终止点不同。每个图像步长会有不同。$x_{0}$ 均为 $0.11$。

![test0](./test0/test_chaos_0.png)
![test1](./test1/test_chaos_1.png)
![test2](./test2/test_chaos_2.png)
![test3](./test3/test_chaos_3.png)

同时，起始点设置为 $-5$ ，终止点为 $5$ 的两幅图，$x_{0}$ 分别为 $0.11$，$0.15$。

![](./fig/fig2.png)
![](./fig/fig3.png)

负半部分本身就只是相当于一个不同的 $x_0$，可以看出 $x_{0}$ 的不同对于结果而言只是一些形状上的差异，但不会影响周期分叉点、混沌状态等。

下面再给出 $Lyapunov$ 图的结果：

![](./test1/test_lyapunov_1.png)
![](./test3/test_lyapunov_3.png)

需要特别注意，第一个等于 $0$ 的并非实际倍周期分叉点，可以从上面的图中看出，分叉仅有一支。这也说明 $Lyapunov$ 指数本身等于0只能判断是否有一个”不光滑“的点。下面以真正的第一个倍周期分叉点为例给出结果：

![](./test4/test_chaos_4.png)
![](./test4/test_lyapunov_4.png)

上图是第一个倍周期分叉点的 $\lambda-x$ 及 $\lambda-lyapunov$ 图，也可以看出存在一定误差，这个误差一方面是 $x$ 值计算中计算机浮点数的舍入误差导致（会导致曲线提前岔开，即如果只看 $\lambda-x$ 的数据点数值，大概在 $\lambda=0.719900$ 处就已经分叉开了，也正是因为这个原因才采用 $Lyapunov$ 指数来减小误差。），另一方面是我采用的 $Lyapunov$ 指数的计算算法比较粗略，会有一定误差。

所有的倍周期分叉点结果在下面给出。

<br>

#### **倍周期分叉点、Feigenbaum常数:**

通过上面的方法得到的各倍周期分叉点如下（可以在peak文件中看到）:

|  i   |        分叉        |   $\lambda$    | $\frac{\lambda_{i}-\lambda_{i-1}}{\lambda_{i+1}-\lambda_{i}}$ |
| :--: | :----------------: | :------: | :--------------------------------------: |
|  1   |  $1\rightarrow2$   | 0.71996046 |                                          |
|  2   |  $2\rightarrow4$   | 0.83326579 |                 4.4708693                 |
|  3   |  $4\rightarrow8$   | 0.85860881 |                 4                 |
|  4   |  $8\rightarrow16$  | 0.86408530 |                 4.655612                 |
|  5   | $16\rightarrow32$  | 0.86525888 |                 4.666666                 |
|  6   | $32\rightarrow64$  | 0.86550272 |                 4.666666                 |
|  7   | $64\rightarrow128$ | 0.86556484 |                                   