## <center>**计算物理 作业报告3**</center>

<center>PB16000647 羊达明</center>

#### **题目:**
进行单中心**扩散限制凝聚** (Diffusion-limited Aggregation,DLA)模型的模拟，并用两种方法计算模拟得到的DLA图形的分形维数，求分形维数时需要作出双对数图。

<br>

#### **算法思路:**

**DLA模拟**

模拟DLA的过程分以下几个步骤
- 初始化边界，网格，凝聚中心
- 在一定范围内随机产生粒子，并进行随机行走
- 当粒子与团簇相遇时停止运动，成为团簇的一部分
- 重复前两步
  
其中需要注意的几点是：
1. 所谓网格用大数组实现，团簇占有部分取值为1，不然为0
2. 产生随机粒子的范围并非是整个初始化时的边界内，而是随着团簇动态变化的一个区域，称为动态边界
3. 粒子随机行走方向有八个，即上、下、左、右、左上、左下、右上、右下
4. 当粒子超出动态边界时，处理方法是移动到相对的一侧动态边界（直接产生下一个随机粒子也可）
5. 粒子与团簇相遇即相邻

**分形维数**

采用Sandbox法和盒计数法计算分形维数
- **Sandbox法**

Sandbox方法简单来说是在越来越大的“盒子”中统计其中的粒子数，以此来计算分形维数。具体公式如下：
$$
N=r^D
$$

- **盒计数法**

Sandbox方法计算得到的图形分形维数为1.573，盒计数法计算得的分形维数为1.594，相差0.02，较为相近。

再分别计算如下12000个团簇粒子生成的DLA图形的分形维数，两种方法得到的分形维数相差0.007。


#### **程序使用说明：**

编程环境：Ubuntu，要预装 C 和 Python3

- dla.c                            C 语言编写的计算程序，负责计算并输出数据点 
- dla                               编译后在Linux系统可执行的文件
- plot.py                         Python 编写的绘制DLA模型图片的脚本
- dynamic_image.py    Python 编写的绘制DLA模型动图的脚本
- sandbox.py                用sandbox方法计算分形维数，并绘制双对数图
- boxcounting.py               用盒计数法计算分形维度，并绘制双对数图

分别执行以下三条命令：

```python
$ gcc dla.c -o dla              # 编译 dla.c 程序
$ ./dla > data                  # 在当前目录下执行 chaos 程序，并将结果输出到 data 文件
$ python plot.py                # 执行绘图程序，将生成的图片保存为 pdf 和 png 格式，同时复制数据
$ python3 dynamic_image.py      # 执行绘图程序，生成动图保存为 gif 格式，同时复制数据
```

在执行第二条命令后会输出如下信息，提醒用户输入相关参数：

```python
Please input how many particle you want(Positive integer): 11000  # 输入想得到的团簇粒子数量
Totally 11000 particles!
```

在执行第三条命令后，可以在results文件夹中得到三个文件：

- *.txt         当前条件下得到的数据文件
- *.pdf        当前条件下得到的图片
- *.png       当前条件下得到的图片

###单中心DLA模型模拟

设置团簇粒子数量，从少到多的结果。

<img src="/home/jenny42/program/DLA/results/800.png"  >

<img src="/home/jenny42/program/DLA/results/2000.png" >

<img src="/home/jenny42/program/DLA/results/5000.png" >

<img src="/home/jenny42/program/DLA/results/18000.png" >

<img src="/home/jenny42/program/DLA/results/30000.png" >

看DLA模型系统演化的动图：

<img src="/home/jenny42/program/DLA/results/11000ani.gif", >

<img src="/home/jenny42/program/DLA/results/11000.png" >

一开始没处理好边界关系（将随机生长边界设置为定值），出现团簇生长碰到生成粒子的边界，导致沿着边界生长的情况，如下：

<img src="/home/jenny42/program/DLA/results/figure_1-2.png" >

### 计算分形维数


### 总结

- 写模拟的DLA模型主程序时，难点在于几个边界关系的处理，比较琐碎、需要注意很多的细节。

- 生成伪随机数的时候，注意要用到不同的种子，否则每次的结果都一样。虽然每次得到的图形都不同，但外观上都是分叉的形状，很相似。

- 要做模型演化的动图时，还需要额外学习画动图的方法，也会花去不少时间。

- 另外在学习用两种不同的方法计算所得到的DLA图形的分形维数时，也需要对数据进行较多的处理，不同的方法处理方法不同，都会花去较多时间写程序。

